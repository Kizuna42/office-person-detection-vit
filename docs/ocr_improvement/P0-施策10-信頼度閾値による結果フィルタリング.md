# P0-施策10: 信頼度閾値による結果フィルタリング

## 優先度
**P0（緊急対応: 即座に実施）**

## 目的
信頼度が低い結果を除外し、誤認識を防止する。

## 問題背景
- 信頼度0.00の結果が採用されている（フレーム23931-23939）
- 信頼度が低い結果でも、時系列補正ロジックが適用されてしまう
- 信頼度の閾値によるフィルタリングが不足

## 実装内容

### 1. 信頼度0.00の結果を自動除外
- `_multi_ocr_vote()`内で、信頼度0.00の結果を除外
- 信頼度が負の値の結果も除外
- 除外された結果は警告ログに記録

### 2. 信頼度閾値の設定
- 信頼度閾値（デフォルト: 0.3）を設定
- 閾値以下の結果は警告ログに記録
- 設定ファイルから閾値を変更可能

### 3. 信頼度が低い場合の再試行
- 信頼度が低い場合は、近傍フレームでの再試行を実施
- 複数のOCRエンジンで再試行
- 再試行でも信頼度が低い場合は、Noneを返す

## 期待効果
**精度向上: 30-50%**

## 実装ファイル
- `src/timestamp/timestamp_extractor.py`
  - `_multi_ocr_vote()`メソッドの修正
  - `extract_with_confidence()`メソッドの修正
  - 新規パラメータ: `confidence_threshold`

## 実装工数
**1-2日**

## 検証方法
- 信頼度0.00の結果の除外率を測定
- 信頼度閾値によるフィルタリングの効果を評価
- 再試行の成功率を測定

## 成功基準
- 信頼度0.00の結果の除外率 ≥ 95%
- 信頼度閾値によるフィルタリングの精度 ≥ 90%
- 再試行の成功率 ≥ 70%

## 関連施策
- 施策9: 最後のフレーム検証と再試行メカニズム（連携必要）
- 施策11: 時系列補正の改善（連携可能）


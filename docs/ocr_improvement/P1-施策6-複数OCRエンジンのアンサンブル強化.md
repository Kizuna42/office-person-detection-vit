# P1-施策 6: 複数 OCR エンジンのアンサンブル強化

## 優先度

**P1（重要対応: 1-2 週間以内）**

## 目的

単一エンジンの誤認識を補完し、複数エンジンの結果を統合する。

## 問題背景

- Tesseract のみに依存（PaddleOCR、EasyOCR はオプション）
- PSM 設定の多数決は実装済みだが、日付部分の誤認識には効果が限定的
- **コード箇所**: `src/timestamp/timestamp_extractor.py:140-236`

## 実装内容

### 1. 重み付き投票

- Tesseract、PaddleOCR、EasyOCR の結果を重み付き投票
- 各エンジンの信頼度に基づく重み付け
- 信頼度が低い結果は重みを下げる

### 2. 信頼度に基づく重み付け

- 各エンジンの信頼度を評価
- 信頼度に応じた重みを設定
- 動的な重み調整（過去の性能に基づく）

### 3. Levenshtein 距離による結果の類似度評価

- 各エンジンの結果の類似度を評価
- 類似度が高い結果を優先
- 外れ値の検出と除外

## 期待効果

**精度向上: 25-35%**

## 実装ファイル

- `src/timestamp/ocr_engines.py`
  - 新規メソッド: `ensemble_ocr_results()`
  - 新規メソッド: `calculate_weighted_vote()`
- `src/timestamp/timestamp_extractor.py`
  - `_multi_ocr_vote()`メソッドの拡張
  - 新規メソッド: `_evaluate_result_similarity()`

## 実装工数

**2-3 日**

## 検証方法

- 複数エンジンでのアンサンブル効果を評価
- 重み付き投票の精度を測定
- Levenshtein 距離による類似度評価の効果を確認

## 成功基準

- アンサンブルによる精度向上 ≥ 25%
- 重み付き投票の精度 ≥ 95%
- 外れ値検出の精度 ≥ 90%

## 関連施策

- 施策 3: 日付部分の独立検証（P0、連携可能）
- 施策 8: タイムスタンプ専用モデルの検討（P2、後続）

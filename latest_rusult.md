## ベースライン評価システム - 現状レポート

### 全体概要

**セッションID**: `20251114_164249`
**評価実行日時**: 2025-11-14 17:29:21
**パイプライン実行日時**: 2025-11-14 16:42:49

---

## 1. パイプライン実行結果

### 処理フレーム数
- 抽出フレーム数: 4フレーム
- 抽出成功率: 100%

### 検出・追跡結果
- 総検出数: 85件
- フレームあたり平均: 21.25件
- 処理フレーム数: 4フレーム

### 処理時間（フェーズ別）

| フェーズ | 処理時間 | 備考 |
|---------|---------|------|
| フレーム抽出 | 32.06秒 | タイムスタンプ抽出に時間 |
| 人物検出 | 2.69秒 | 4フレーム処理 |
| トラッキング | 2.25秒 | DeepSORTアルゴリズム |
| 座標変換 | 0.005秒 | 高速 |
| 集計処理 | 0.003秒 | 高速 |
| 可視化 | 0.60秒 | グラフ・フロアマップ生成 |

**合計処理時間**: 約37.6秒（4フレーム）

---

## 2. 評価結果サマリー

### 達成状況

| 評価項目 | 結果 | 目標値 | 達成状況 |
|---------|------|--------|----------|
| **IDF1** | 1.000 | ≥ 0.8 | ✅ 達成 |
| **MOTA** | 0.000 | ≥ 0.7 | ❌ 未達成 |
| **再投影平均誤差** | 63.75 px | ≤ 2.0 px | ❌ 未達成 |
| **再投影最大誤差** | 545.65 px | ≤ 4.0 px | ❌ 未達成 |
| **処理時間/フレーム** | 測定失敗 | ≤ 2.0秒 | ❌ 未測定 |
| **メモリ使用量** | 測定失敗 | ≤ 12GB | ❌ 未測定 |

**全体評価**: ❌ 6項目中1項目のみ達成

---

## 3. MOTメトリクス（追跡精度）

### 結果詳細

```
MOTA (Multiple Object Tracking Accuracy): 0.000
├─ 目標値: ≥ 0.7
└─ 評価: ❌ 未達成（検出と追跡の一致度が低い）

IDF1 (Identity F1-score): 1.000
├─ 目標値: ≥ 0.8
└─ 評価: ✅ 達成（IDの一致度は高い）

ID Switches: 0.0
└─ 評価: ✅ 良好（IDの切り替えなし）
```

### データ
- Ground Truthトラック数: 20
- 予測トラック数: 21
- 評価フレーム数: 100フレーム（想定）

### 分析
- IDF1が1.0なのにMOTAが0.0は、IDの一致は高いが検出位置の一致度が低い可能性。
- 検出位置の精度改善が必要。

---

## 4. 再投影誤差（座標変換精度）

### 結果詳細

```
平均誤差: 63.75 ピクセル
├─ 目標値: ≤ 2.0 px
└─ 評価: ❌ 未達成（目標の約32倍）

最大誤差: 545.65 ピクセル
├─ 目標値: ≤ 4.0 px
└─ 評価: ❌ 未達成（目標の約136倍）

最小誤差: 0.26 ピクセル
└─ 評価: ✅ 良好（一部は高精度）

標準偏差: 113.95 ピクセル
└─ 評価: ❌ 誤差のばらつきが大きい
```

### 誤差分布
- 対応点数: 24点
- 誤差範囲: 0.26 px ～ 545.65 px
- 誤差マップ: `reprojection_error_map.png` に可視化済み

### 分析
- ホモグラフィ行列の精度が不十分。
- 一部の対応点で大きな誤差（最大545.65 px）。
- キャリブレーションの見直しが必要。

---

## 5. パフォーマンス評価

### 現状
- 評価失敗（スクリプトのバグ）
- エラー内容: `ValueError: too many values to unpack (expected 3)`
- 発生箇所: `scripts/measure_performance.py` → `detection.py`のバッチ処理

### 推定パフォーマンス（summary.jsonより）
- 検出処理: 2.69秒 / 4フレーム = 約0.67秒/フレーム
- 目標値: ≤ 2.0秒/フレーム
- 推定評価: ✅ 目標達成（推定）

---

## 6. 生成されたファイル

```
output/sessions/20251114_164249/
├── baseline_metrics.json          ✅ 評価結果サマリー
├── baseline_report.md              ✅ レポート（Markdown）
├── mot_metrics.json                ✅ MOTメトリクス詳細
├── reprojection_error.json         ✅ 再投影誤差詳細
├── reprojection_error_map.png      ✅ 誤差可視化マップ
├── metadata.json                   ✅ セッション設定情報
└── summary.json                    ✅ パイプライン実行サマリー
```

---

## 7. 主な問題点と推奨アクション

### 優先度: 高

1. 再投影誤差が大きい（平均63.75 px、最大545.65 px）
   - 原因: ホモグラフィ行列の精度不足
   - 対応: 対応点の再キャリブレーション
   - 影響: 座標変換精度に直結

2. MOTAが0.0
   - 原因: 検出位置とGround Truthの一致度が低い可能性
   - 対応: 検出パラメータ（confidence_threshold、NMS）の調整
   - 影響: 追跡精度の評価指標

### 優先度: 中

3. パフォーマンス評価スクリプトのバグ
   - 原因: `measure_performance.py`のバッチ処理部分
   - 対応: エラー修正
   - 影響: パフォーマンス評価が実行できない

### 優先度: 低

4. 処理時間の最適化
   - 現状: フレーム抽出に32秒（タイムスタンプ抽出）
   - 対応: タイムスタンプ抽出の最適化
   - 影響: 全体処理時間の短縮

---

## 8. 良い点

1. IDF1が1.0（目標達成）
   - IDの一致度が高い

2. ID Switchesが0
   - IDの誤切り替えなし

3. パイプラインは正常動作
   - 全フェーズが完了
   - エラーなく実行

4. 評価システムは動作
   - MOTメトリクス評価: 成功
   - 再投影誤差評価: 成功
   - レポート生成: 成功

---

## まとめ

### 現状
- システムは正常に動作
- 評価システムも機能
- 精度面で改善が必要

### 次のステップ（推奨順）
1. ホモグラフィ行列の再キャリブレーション（再投影誤差の改善）
2. 検出パラメータの調整（MOTAの改善）
3. パフォーマンス評価スクリプトの修正
4. 処理時間の最適化

### 評価結果ファイル
詳細は以下を参照:
- レポート: `output/sessions/20251114_164249/baseline_report.md`
- 評価結果: `output/sessions/20251114_164249/baseline_metrics.json`
- 誤差マップ: `output/sessions/20251114_164249/reprojection_error_map.png`
